---
title: Lumesh Sys 模块
date: 2025-07-13 19:16:45
highlight: true
tags:
 - libs
 - sys
categories:
 - wiki
 - libs
---

Sys 模块提供了系统级操作和环境管理功能，包括环境变量管理、变量定义检查、表达式引用、错误处理和系统信息获取等核心功能。  所有函数都支持管道操作，并提供统一的错误处理机制。

## 功能概览

| 功能类别 | 主要函数 | 用途 |
|---------|---------|------|
| **环境管理** | `env`, `set`, `unset` | 获取和管理根环境变量 |
| **变量检查** | `vars`, `has`, `defined` | 检查变量定义状态 |
| **表达式操作** | `quote` | 引用表达式 |
| **错误处理** | `error`, `ecodes_rt`, `ecodes_lm` | 错误生成和错误码查询 |
| **系统信息** | `info` | 获取操作系统信息 |
| **输出控制** | `print_tty`, `discard` | TTY 输出和数据丢弃 |

## 环境管理函数

这些函数用于管理系统环境变量：

**`env`** - 获取根环境作为映射
- **参数**：无
- **返回**：`Map` - 根环境的所有变量


**`set <var> <val>`** - 在根环境中定义变量
- **参数**：`var` (必需): `String` - 变量名，`val` (必需): `Any` - 变量值
- **返回**：`None`


**`unset <var>`** - 从根环境中删除变量
- **参数**：`var` (必需): `String` - 要删除的变量名
- **返回**：`None`


## 变量检查函数

这些函数用于检查变量的定义状态：

**`vars`** - 获取当前环境中定义的变量
- **参数**：无
- **返回**：`Map` - 当前环境的变量映射


**`has <var>`** - 检查变量是否在当前环境中定义
- **参数**：`var` (必需): `String` - 要检查的变量名
- **返回**：`Boolean` - 变量是否存在


**`defined <var>`** - 检查变量是否在当前环境树中定义
- **参数**：`var` (必需): `String` - 要检查的变量名
- **返回**：`Boolean` - 变量是否在环境树中定义


## 表达式操作函数

**`quote <expr>`** - 引用表达式
- **参数**：`expr` (必需): `Expression` - 要引用的表达式
- **返回**：`Quote` - 引用的表达式


## 错误处理函数

这些函数用于错误处理和调试：

**`error <msg>`** - 返回运行时错误
- **参数**：`msg` (必需): `String` - 错误消息
- **返回**：抛出 `LmError::CustomError`


**`ecodes_rt`** - 显示运行时错误码
- **参数**：无
- **返回**：`Expression` - 运行时错误码列表


**`ecodes_lm`** - 显示 LmError 错误码
- **参数**：无
- **返回**：`Expression` - LmError 错误码列表


## 系统信息函数

**`info`** - 获取操作系统信息
- **参数**：无
- **返回**：`String` - 操作系统信息字符串


## 输出控制函数

**`print_tty <arg>`** - 向 TTY 打印控制序列
- **参数**：`arg` (必需): `String` - 要打印的内容
- **返回**：`None`


**`discard <arg>`** - 将数据发送到 /dev/null
- **参数**：`arg` (必需): `Any` - 要丢弃的数据
- **返回**：`None`


## Notes

Sys 模块是 Lumesh 内置模块系统的核心组件之一，在模块注册表中注册为 "Sys"。  该模块的函数主要用于系统级操作，与其他模块如 String、From 等应用级模块形成互补。

模块中的 `set` 和 `unset` 函数也作为全局内置函数直接可用，无需模块前缀。
